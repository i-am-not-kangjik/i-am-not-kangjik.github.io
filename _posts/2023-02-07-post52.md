---
title: 2023-02-07 TIL
date: 2023-02-07 19:58:00 +0900
categories: [TIL, playdata]
tags: [ml, scikit-learn, logistic regression]     # TAG names should always be lowercase
---
## 회귀 분석의 유형

- 변수의 개수 및 계수의 형태에 따라 구분한다.
- 독립 변수의 개수에 따라
    - 단순회귀분석: 독립변수가 1개인 경우, 단일 회귀분석이라고도 함
    - 다중회귀분석: 독립변수가 여러 개인 경우
- 회귀 개수의 형태에 따라
    - 선형: 계수를 선형 결합으로 표현할 수 있는 경우
    - 비선형: 계수를 선형 결합으로 표현할 수 없는 경우
- 종속 변수의 개수에 따라
    - 단변량 회귀모델 - 종속변수가 1개인 경우
    - 다변량 회귀모델 - 종속변수가 여러 개인 경우
    

# SQLD, ADSP, ADP, 빅분기

## 선형 회귀

- 선형 회귀란?
    - 종속 변수가 독립 변수와 회귀 계수의 선형 조합으로 표현 가능한 경우
    - 파라미터(계수)에 대한 선형성만을 가정함
- 독립변수, X와 종속 변수, y간의 상호 연관성 정도를 파악하기 위한 분석 기법
- 하나의 변수가 변함에 따라 대응되는 변수가 어떻게 변하는지를 측정하는 것
- 변수 간의 인과관계를 분석할 때 많이 사용
- 독립 변수가 1개이면 단순 회귀 분석, 두 개 이상이면 다중 회귀 분석

## 단순 선형 회귀

- 데이터의 분포를 직선으로 가정하고 데이터를 학습해서 예측
    - 데이터의 분포를 직선으로 가정하고 데이터를 학습해서 예측
    - 독립변수가 1개이고, 종속변수도 1개
    - 독립변수와 종속변수 간의 관계를 선형적으로 파악하는 회귀 방식
    - 독립변수와 종속변수의 관계식:
    
    $$
    y(x) = w_1x + w_0
    $$
    
    - 회귀 계수(codefficient): w1
        - 독립변수가 종속변수에 끼치는 영향력(설명력)의 정도로서, 직선의 기울기(slope)
    - 절편(intercept): w0
        - 독립변수가 0일때 상수 값
- 이 직선이 데이터에 부합하려면, w0와 w1을 어떻게 정해야 할까? (데이터를 설명하는 가장 적절한 기울기와 절편을 어떻게 찾아야 할까?)
    - (𝑦−𝑦 예측치)

## 여러 가지 오차식

- 평균 제곱 오차
- 평균 절대값 오차
- 평균 제곱근 오차
- 오차 - error
- 잔차 - residual
    - 통계학을 깊게 들어가면 다르지만, 머신러닝에선 잔차와 오차를 혼용함

## 잔차 제곱 오차 함수

- 잔차 제곱합(RSS)
    - 모든 데이터 점의 잔차를 제곱하여 합한 것
- 손실함수(lostt function) / 비용함수(cost function)
    - 회귀계수를 추정할 때 손실을 최소화할 목적으로 사용하는 함수
- 직선 모델이 데이터에 부합하려면?
    - 가장 적은 오류를 발생시키는 직선을 찾음
    - 손실함수 값이 최소가 되는 회귀모형을 만듬

## 회귀 계수 탐색(선형 방정식 찾기)

- 최소 제곱법

## 오전 핵심

- 최적의 회귀 모형을 만든다는 것: y = w1X +w0
    - 손실함수(비용함수)인 MSE 값이 최소가 되는 회귀 계수(w1, w0)을 찾는 것
- 수치해적 방법: 경서하강법
    - 반복적인 계산에 의해 근사값을 구하는 수치 계산법
- 해석학적 방법(최소제곱법)

## 결정 계수(Codefficient of Determinant)

- 결정계수: 개체(종속 변수)가 가지는 총 변량 중 회귀식이 설명(차지)하는 변량의 비율
    - R^2 = 예측값의 분산 / 실제값의 분산
    - 평균과 각각의 데이터간의 거리가 분산
    - 1에 가까워질 수록 좋은 모델
    

RMSE(metrics.mean_squared_error에 생김 원래 없었지만..)

summary()

- P > |t| 가 0.05 이상이면 신뢰할 수 없다.

## 스탯츠 모델

- sm.add_constant(X_train)
    - 상수항 결합으로 독립변수에 데이터를 추가
- reg = lr.fit()
- reg.summary 말고 print()로 감싸야 더 이쁘게 나옴

## 다중 선형 회귀

- 단순 선형 회귀에서 독립변순의 개수만 늘어난 것
- 단순 선형 회귀와 동일한 절차를 이용해 분석을 수행
- 그러나 독립 변수의 수가 많아지므로 적절한 조치를 취해야 함

### 독립변수들의 최초 선택

- 회귀분석의 목적: 종족 변수를 가장 잘 설명하는 독립변수들의 성향/특징들을 찾아내어 이를 기반으로 기존의 자료를 설명하거나 새로운 결과를 예측하는 것

### 다중 선형회귀 평가

MSE, RMSE, R2(결정계수), Adj_R2 수정된 결정계수

## 탐색적 데이터 분석(EDA)

- 정의
    - 수집한 데이터를 분석하기 전에 데이터의 특성을 관찰하고 이해하는 관계
    - 원 데이터(Raw Data)를 대상으로 유연하게 데이터를 탐색하고, 데이터의 특징과 구조에 대한 정보를 획득함
- 목적
    - 데이터 종류의 확인과 데이터 간의 관계에 대한 더 나은 이해를 목적으로 함

## 다중 공선성(Multi-collinearity) 문제

- 다수의 독립변수가 서로 강한 상관 관계(0.9)가 나타나는 것을 다중 공선성이라 한다.
(즉, 어떤 독립변수의 값이 독립적이지 않고 다른 독립변수(들)의 값에 의해서 결정된다는 것)